---
title: "Class 10 Structural Bioinformatics"
author: "Austin Teel (A17293709)"
toc: TRUE
format: pdf
---

## Background 
The [Protein Data Bank (PDB)](http://www.rcsb.org/) is the main repository of main biomecular structure data. Let's see what is in it:


## PDB Statistics

```{r}
Stats <- read.csv("pdb_stats.csv", row.names=1)

head(Stats)
```


> Q1: What percentage of structures in the PDB are solved by X-Ray and Electron Microscopy.

```{r}
n.sums <- colSums(Stats)
n <- n.sums/n.sums["Total"]
round(n, digits=2)
```


The percentage of structures in the PDB that are solved by X-ray are 81% while EM is 13%.

> What is the total number of entries in the PDB

```{r}
n.sums["Total"]
```

The total number of entries is 249,018.


> Q2: What proportion of structures in the PDB are protein?

```{r}
r.sums <- rowSums(Stats)
r <- r.sums/n.sums["Total"]
round(r, digits=2)
```


> Q3: Type HIV in the PDB website search box on the home page and determine how many HIV-1 protease structures are in the current PDB?

In the current PDB there are 38 HIV protease structures.



## Visualizing the HIV-1 protease structure


## Using Molstar

We can use the main [Molstar viewer online](https://molstar.org/viewer/).

![First View of HIV-Pr dimer with Bound Inhibitor](1HSG.png)
> Q. Generate and insert an image of HIV-Pr cartoon colored by secondary structure, showing the inhibitor (ligand) in ball and stick.

![View of HIV-Pr dimer with cartoon colored by secondary structure showing the inhibitor (ligand) in ball and stick](1HSG (1).png)

> Q. Generate a final image showing catalytic APS 25 as ball and stick and the all-important active site water molecule as spacefill.


![View of HIV-Pr dimer with cartoon colored by secondary structure](1HSG (3).png)

> Q4: Water molecules normally have 3 atoms. Why do we see just one atom per water molecule in this structure?

We only see one water molecule in this structure because the structure is only showing one atom from this molecule where it is binding or center of molecule in order to conserve space.


> Q5: There is a critical “conserved” water molecule in the binding site. Can you identify this water molecule? What residue number does this water molecule have?

The water molecule is displayed in the picture above and the residue number of this water molecule is Water 308.



> Q6: Generate and save a figure clearly showing the two distinct chains of HIV-protease along with the ligand. You might also consider showing the catalytic residues ASP 25 in each chain and the critical water (we recommend “Ball & Stick” for these side-chains). Add this figure to your Quarto document.

See photos above.


> Discussion Topic: Can you think of a way in which indinavir, or even larger ligands and substrates, could enter the binding site?

## Introduction to BIo3D in R

```{r}
library(bio3d)
hiv <- read.pdb("1hsg")
hiv
```

```{r}
head(hiv$atom)
```

```{r}
pdbseq(hiv)
```

Let's try out the new **bio3dview** package that is not yet on CRAN.
We can use the **remotes** package to install any R package from GitHub.

```{r}
library(bio3dview)

sele <- atom.select(hiv, resno=25)

#view.pdb(hiv, backgroundColor="lightblue",
        #highlight=sele, highlight.style="spacefill")
```



> Q7: How many amino acid residues are there in this pdb object? 

There are 198 amino acids and this can be found from CAlpha atoms.


> Q8: Name one of the two non-protein residues? 

Two non protein residues are HOH (127) and MK1 (1).


> Q9: How many protein chains are in this structure? 

There are 2 protein chains in this structure.



## Prediction of protein dynamics

```{r}
adk <- read.pdb("6s36")
m <- nma(adk)
plot(m)
```

write out our results as a wee trajectory movie: 

```{r}
mktrj(m, file="results.pdb")
```


```{r}
#view.nma(m)
```


## Comparative protein structure analysis with RNA

We will start with a database id 1ake_A
```{r}
library(bio3d)
id <- "1ake_A"
aa <- get.seq(id)
```

```{r}
blast <- blast.pdb(aa)
```

Have a wee peak:
```{r}
head(blast$hit.tbl)
```

```{r}
hits <- plot(blast)
```

Peak at our "top hits"

```{r}
head(hits$pdb.id)
```

Now we can download these "top hits" these will all be ADK structures in the PDB database.
```{r}
files <- get.pdb(hits$pdb.id, path="pdbs", split=TRUE, gzip=TRUE)
```


we need one package from BioConductor. To set this up we first need to first install a package called **"BiocManager"** from CRAN.

Now we can use the `install()` function from this package like this:
`BiocManager::install("msa")`

```{r}
pdbs <- pdbaln(files, fit = TRUE, exefile="msa")
```

Let's have a wee peak at our structures after "fitting" or superposing:

```{r}
library(bio3dview)

view.pdbs(pdbs, colorScheme="residue")
```


We can run function like `rmsd()`,`rmsf()`, and the best `pca()`
```{r}
pc.xray <- pca(pdbs)
plot(pc.xray)
```

```{r}
plot(pc.xray, 1:2)
```


Finally, let's make  a wee movie of the major "motion" or structural difference in the dataset - we call this a "trajectory"

```{r}
mktrj(pc.xray, file="results.pdb")
```























